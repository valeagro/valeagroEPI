<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0b6e4f"/>
  <title>Agrovale — Controle EPIs (Herbicida)</title>
  <link rel="manifest" href="./manifest.json" />
  <link rel="apple-touch-icon" href="./icons/icon-192.png" />
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <header>
    <h1>Agrovale — EPIs (Herbicida)</h1>
    <p class="subtitle">Controle de entradas e saídas · Funciona offline</p>
  </header>

  <main>
    <section class="form-card">
      <h2>Novo registro</h2>
      <form id="epi-form" autocomplete="off">
        <label>
          Nome do colaborador
          <input id="employee" required placeholder="Ex: João Silva" />
        </label>
        <label>
          Matrícula / ID
          <input id="employee-id" placeholder="Opcional" />
        </label>
        <label>
          EPI
          <input id="epi-name" required placeholder="Ex: Máscara P3" />
        </label>
        <label>
          Quantidade
          <input id="quantity" type="number" min="1" value="1" required />
        </label>
        <label>
          Ação
          <select id="action">
            <option value="saida">Saída</option>
            <option value="entrada">Entrada</option>
          </select>
        </label>
        <div class="buttons">
          <button type="submit">Registrar</button>
          <button type="button" id="clear-btn" class="secondary">Limpar</button>
        </div>
      </form>
    </section>

    <section class="list-card">
      <h2>Registros</h2>
      <div class="controls">
        <input id="search" placeholder="Pesquisar por nome, EPI ou ação" />
        <button id="export-balance-btn" class="secondary">Gerar Balanço (Dia)</button>
        <button id="export-transactions-btn">Exportar Log (Tudo)</button>
        <button id="clear-all" class="danger">Apagar todos</button>
      </div>
      <ul id="records"></ul>
    </section>
  </main>

  <footer>
    <small>Agrovale — Herbicida · PWA · LocalStorage</small>
  </footer>

  <div id="toast" class="toast" hidden></div>

  <dialog id="export-modal">
    <form id="export-balance-form">
      <h3>Gerar Balanço Diário</h3>
      <p>Preencha para calcular o balanço de um EPI em um dia específico.</p>
      
      <label>
        Data para o balanço
        <input type="date" id="export-date" required />
      </label>
      
      <label>
        Nome exato do EPI
        <input id="export-epi-name" required placeholder="Ex: Máscara P3" />
      </label>

      <label>
        Saldo Anterior (do dia anterior)
        <input id="export-saldo-anterior" type="number" min="0" value="0" required />
      </label>

      <div class="modal-buttons">
        <button type="button" id="modal-cancel-btn" class="secondary">Cancelar</button>
        <button type="submit">Gerar CSV</button>
      </div>
    </form>
  </dialog>
  <script defer src="./app.js"></script>
  <script>
    if ('serviceWorker' in navigator && location.protocol.startsWith('http')) {
      navigator.serviceWorker.register('./sw.js')
        .catch(err => console.warn('Falha ao registrar SW:', err));
    }
  </script>
</body>
</html>
